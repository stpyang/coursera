# Reproducible Research: Peer Assessment 1

## Loading the preprocessing the data ##

We load the data and replace the date column with Date objects.

```{r}
unzip("activity.zip")
data <- read.csv(file="activity.csv")
data$date <- as.Date(data$date)
```

## What is the mean total number of steps taken per day? ##
We use ggplot2 to create a histogram of the average number of steps taken per day.

```{r, echo=FALSE, eval=FALSE}
## IGNORE THIS CHUNK!!! ##
numBins <- 10
stepsPerDay <- tapply(data$steps, data$date, sum, na.rm =TRUE)
hist(stepsPerDay,
     breaks=numBins,
     main = "Histograms of steps taken per day",
     xlab = "Steps per day",
     ylab = "Frequency")
```

```{r, echo=TRUE, eval=TRUE}
library(ggplot2)
numBins <- 10
stepsPerDay <- tapply(data$steps, data$date, sum, na.rm =TRUE)
stepsPerDay <- data.frame(stepsPerDay)
names(stepsPerDay) <- c("steps")
qplot(steps,
      data=stepsPerDay,
      binwidth=max(stepsPerDay)/numBins,
      main = "Histograms of steps taken per day",
      xlab = "Steps per day",
      ylab = "Frequency")
```

The **mean** number of steps per day is **9354.23**, and the **median** number of
steps per day is **10395**.  This was found using the code below, but can also be found by calling `summary(stepsPerDay)`.

```{r, echo=TRUE, eval=TRUE}
mean(stepsPerDay$steps); median(stepsPerDay$steps)
```

## What is the average daily activity pattern? ##

We make a time series plot of the 5-minute interval and the
average number of steps taken, averaged across all days.

```{r, echo=FALSE, eval=FALSE}
## IGNORE THIS CHUNK!!! ##
meanStepsPerInterval <- tapply(data$steps, data$interval, mean, na.rm=TRUE)
interval <- as.numeric(rownames(meanStepsPerInterval))
plot(interval,
     meanStepsPerInterval, type="l",
     main="Average number of steps taken per interval",
     xlab = "Five-minute Interval",
     ylab = "Average steps taken")
```

```{r, echo=TRUE, eval=TRUE}
library(ggplot2)
meanStepsPerInterval <- tapply(data$steps, data$interval, mean, na.rm=TRUE)
interval <- as.numeric(rownames(meanStepsPerInterval))
df <- data.frame(interval, meanStepsPerInterval)
ggplot(df, aes(x=interval, y=meanStepsPerInterval)) +
    geom_line() +
    ggtitle("Average number of steps taken per interval") +
    xlab("Five-minute Interval") +
    ylab("Average steps taken")
```

The five-minute interval starting at **835** represents the most active time.  This was found by calling the code below

```{r, echo=TRUE, eval=TRUE}
which.max(df$meanStepsPerInterval)
```

## Imputing missing values ##

The total number of missing values in the dataset is **2304**.  This was found by running the code below, though it an also be found by calling `summary(data)`.

```{r, echo=TRUE, eval=TRUE}
sum(is.na(data$steps))
```

We replace all NA values in `data$steps` with the mean number of steps per
corresponding interval.

```{r, echo=TRUE, eval=TRUE}
for (i in 1:length(data$steps)) {
    data$steps[i] <- ifelse(is.na(data$steps[i]),
                            meanStepsPerInterval[as.character(data$interval[i])],
                            data$steps[i])
}
```


## Are there differences in activity patterns between weekdays and weekends? ##

We create a new factor variable in the dataset with two levels---"weekday"" and
"weekend".

```{r, echo=TRUE, eval=TRUE}
weekday <- weekdays(data$date)
type <- ifelse(weekday == "Saturday" | weekday == "Sunday", "weekend", "weekday")
type <- factor(type)
```

We use ggplot1 to make a panel plot containing a time series plot of the
5-minute interval and the average number of steps taken, averaged
across all weekday days or weekend days.

```{r, echo=FALSE, eval=FALSE}
## IGNORE THIS CHUNK!!! ##
df <- tapply(data$steps, list(data$interval, type), mean)
interval <- as.numeric(row.names(df))

par(mfrow=c(2,1))
plot(interval, df[,"weekday"], type="l",
     main="Weekdays",
     xlab="Interval",
     ylab="Average number of steps")
plot(interval, df[,"weekend"], type="l",
     main="Weekends",
     xlab="Interval",
     ylab="Average number of steps")
```

```{r, echo=TRUE, eval=TRUE}
library(plyr)
df <- ddply(.data=data.frame(data$steps),
            .variables=.(data$interval, type),
            colwise(mean))
names(df) <- c("interval", "type", "stepsPerInterval")
ggplot(df, aes(x=interval, y=stepsPerInterval)) +
    geom_line() +
    facet_grid(type~.) +
    xlab("Interval") +
    ylab("Average number of steps")
```

[data]: https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip
